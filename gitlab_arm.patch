diff -aur gitlabhq-8.14.0/Gemfile modified/Gemfile
--- gitlabhq-8.14.0/Gemfile	2016-11-22 18:59:56.000000000 +0100
+++ modified/Gemfile	2016-11-26 18:07:38.885319272 +0100
@@ -93,6 +93,7 @@
 gem 'fog-rackspace', '~> 0.1.1'
 
 # for aws storage
+gem 'unf_ext', :git => 'https://github.com/gzmorell/ruby-unf_ext.git'
 gem 'unf', '~> 0.1.4'
 
 # Seed data
diff -aur gitlabhq-8.14.0/Gemfile.lock modified/Gemfile.lock
--- gitlabhq-8.14.0/Gemfile.lock	2016-11-22 18:59:56.000000000 +0100
+++ modified/Gemfile.lock	2016-11-26 18:07:38.885319272 +0100
@@ -1,8 +1,14 @@
+GIT
+  remote: https://github.com/gzmorell/ruby-unf_ext.git
+  revision: da1c8dfb67b0e3f6b765ffd1e2078b6c1094e69d
+  specs:
+    unf_ext (0.0.7.2)
+
 GEM
   remote: https://rubygems.org/
   specs:
     RedCloth (4.3.2)
-    ace-rails-ap (4.1.0)
+    ace-rails-ap (4.1.1)
     actionmailer (4.2.7.1)
       actionpack (= 4.2.7.1)
       actionview (= 4.2.7.1)
@@ -53,31 +59,28 @@
       faraday_middleware (~> 0.9)
       faraday_middleware-multi_json (~> 0.0)
       oauth2 (~> 1.0)
-    asciidoctor (1.5.3)
+    asciidoctor (1.5.5)
     ast (2.3.0)
     attr_encrypted (3.0.3)
       encryptor (~> 3.0.0)
-    attr_required (1.0.0)
-    autoprefixer-rails (6.2.3)
+    attr_required (1.0.1)
+    autoprefixer-rails (6.5.3)
       execjs
-      json
     awesome_print (1.2.0)
     axiom-types (0.1.1)
       descendants_tracker (~> 0.0.4)
       ice_nine (~> 0.11.0)
       thread_safe (~> 0.3, >= 0.3.1)
-    azure (0.7.5)
+    azure (0.7.7)
       addressable (~> 2.3)
       azure-core (~> 0.1)
       faraday (~> 0.9)
       faraday_middleware (~> 0.10)
-      json (~> 1.8)
-      mime-types (>= 1, < 3.0)
+      mime-types (>= 1, < 4.0)
       nokogiri (~> 1.6)
       systemu (~> 2.6)
       thor (~> 0.19)
-      uuid (~> 2.0)
-    azure-core (0.1.2)
+    azure-core (0.1.6)
       faraday (~> 0.9)
       faraday_middleware (~> 0.10)
       nokogiri (~> 1.6)
@@ -94,19 +97,19 @@
       erubis (>= 2.6.6)
     binding_of_caller (0.7.2)
       debug_inspector (>= 0.0.1)
-    bootstrap-sass (3.3.6)
+    bootstrap-sass (3.3.7)
       autoprefixer-rails (>= 5.2.1)
       sass (>= 3.3.4)
-    brakeman (3.3.2)
-    browser (2.2.0)
+    brakeman (3.3.5)
+    browser (2.3.0)
     builder (3.2.2)
-    bullet (5.2.0)
+    bullet (5.2.1)
       activesupport (>= 3.0.0)
       uniform_notifier (~> 1.10.0)
     bundler-audit (0.5.0)
       bundler (~> 1.2)
       thor (~> 0.18)
-    byebug (8.2.1)
+    byebug (8.2.5)
     capybara (2.6.2)
       addressable
       mime-types (>= 1.16)
@@ -114,7 +117,7 @@
       rack (>= 1.0.0)
       rack-test (>= 0.5.4)
       xpath (~> 2.0)
-    capybara-screenshot (1.0.11)
+    capybara-screenshot (1.0.14)
       capybara (>= 1.0, < 3)
       launchy
     carrierwave (0.10.0)
@@ -127,9 +130,9 @@
     chronic (0.10.2)
     chronic_duration (0.10.6)
       numerizer (~> 0.1.1)
-    chunky_png (1.3.5)
+    chunky_png (1.3.8)
     cliver (0.3.2)
-    coderay (1.1.0)
+    coderay (1.1.1)
     coercible (1.0.0)
       descendants_tracker (~> 0.0.1)
     coffee-rails (4.1.1)
@@ -138,18 +141,18 @@
     coffee-script (2.4.1)
       coffee-script-source
       execjs
-    coffee-script-source (1.10.0)
-    colorize (0.7.7)
+    coffee-script-source (1.11.1)
+    colorize (0.8.1)
     concurrent-ruby (1.0.2)
-    connection_pool (2.2.0)
+    connection_pool (2.2.1)
     crack (0.4.3)
       safe_yaml (~> 1.0.0)
     creole (0.5.0)
-    css_parser (1.4.1)
+    css_parser (1.4.6)
       addressable
-    d3_rails (3.5.11)
+    d3_rails (3.5.17)
       railties (>= 3.1.0)
-    daemons (1.2.3)
+    daemons (1.2.4)
     database_cleaner (1.5.3)
     debug_inspector (0.0.2)
     debugger-ruby_core_source (1.3.8)
@@ -178,9 +181,9 @@
     docile (1.1.5)
     doorkeeper (4.2.0)
       railties (>= 4.2)
-    dropzonejs-rails (0.7.2)
+    dropzonejs-rails (0.7.3)
       rails (> 3.1)
-    email_reply_parser (0.5.8)
+    email_reply_parser (0.5.9)
     email_spec (1.6.0)
       launchy (~> 2.1)
       mail (~> 2.2)
@@ -188,9 +191,9 @@
     equalizer (0.0.11)
     erubis (2.7.0)
     escape_utils (1.1.1)
-    eventmachine (1.0.8)
-    excon (0.52.0)
-    execjs (2.6.0)
+    eventmachine (1.2.1)
+    excon (0.54.0)
+    execjs (2.7.0)
     expression_parser (0.9.0)
     factory_girl (4.5.0)
       activesupport (>= 3.0.0)
@@ -199,20 +202,20 @@
       railties (>= 3.0.0)
     faraday (0.9.2)
       multipart-post (>= 1.2, < 3)
-    faraday_middleware (0.10.0)
-      faraday (>= 0.7.4, < 0.10)
+    faraday_middleware (0.10.1)
+      faraday (>= 0.7.4, < 1.0)
     faraday_middleware-multi_json (0.0.6)
       faraday_middleware
       multi_json
     ffaker (2.0.0)
-    ffi (1.9.10)
+    ffi (1.9.14)
     flay (2.6.1)
       ruby_parser (~> 3.0)
       sexp_processor (~> 4.0)
     flowdock (0.7.1)
       httparty (~> 0.7)
       multi_json
-    fog-aws (0.11.0)
+    fog-aws (0.12.0)
       fog-core (~> 1.38)
       fog-json (~> 1.0)
       fog-xml (~> 0.1)
@@ -222,24 +225,24 @@
       fog-core (~> 1.27)
       fog-json (~> 1.0)
       fog-xml (~> 0.1)
-    fog-core (1.42.0)
+    fog-core (1.43.0)
       builder
       excon (~> 0.49)
       formatador (~> 0.2)
-    fog-google (0.3.2)
+    fog-google (0.4.2)
       fog-core
       fog-json
       fog-xml
     fog-json (1.0.2)
       fog-core (~> 1.0)
       multi_json (~> 1.10)
-    fog-local (0.3.0)
+    fog-local (0.3.1)
       fog-core (~> 1.27)
-    fog-openstack (0.1.6)
-      fog-core (>= 1.39)
+    fog-openstack (0.1.18)
+      fog-core (>= 1.40)
       fog-json (>= 1.0)
       ipaddress (>= 0.8)
-    fog-rackspace (0.1.1)
+    fog-rackspace (0.1.2)
       fog-core (>= 1.35)
       fog-json (>= 1.0)
       fog-xml (>= 0.1)
@@ -247,7 +250,7 @@
     fog-xml (0.1.2)
       fog-core
       nokogiri (~> 1.5, >= 1.5.11)
-    font-awesome-rails (4.6.1.0)
+    font-awesome-rails (4.6.3.1)
       railties (>= 3.2, < 5.1)
     foreman (0.78.0)
       thor (~> 0.19.1)
@@ -257,9 +260,9 @@
       ruby-progressbar (~> 1.4)
     gemnasium-gitlab-service (0.2.6)
       rugged (~> 0.21)
-    gemojione (3.0.1)
+    gemojione (3.2.0)
       json
-    get_process_mem (0.2.0)
+    get_process_mem (0.2.1)
     gherkin-ruby (0.3.2)
     github-linguist (4.7.6)
       charlock_holmes (~> 0.7.3)
@@ -298,7 +301,7 @@
       rouge (~> 2.0)
       sanitize (~> 2.1.0)
       stringex (~> 2.5.1)
-    gollum-rugged_adapter (0.4.2)
+    gollum-rugged_adapter (0.4.3)
       mime-types (>= 1.15)
       rugged (~> 0.24.0, >= 0.21.3)
     gon (6.1.0)
@@ -321,19 +324,19 @@
       multi_json (>= 1.3.2)
     haml (4.0.7)
       tilt
-    haml_lint (0.18.2)
+    haml_lint (0.18.4)
       haml (~> 4.0)
       rake (>= 10, < 12)
       rubocop (>= 0.36.0)
       sysexits (~> 1.1)
-    hamlit (2.6.1)
+    hamlit (2.6.2)
       temple (~> 0.7.6)
       thor
       tilt
-    hashie (3.4.4)
+    hashie (3.4.6)
     health_check (2.2.1)
       rails (>= 4.0)
-    hipchat (1.5.2)
+    hipchat (1.5.4)
       httparty
       mimemagic
     html-pipeline (1.11.0)
@@ -345,14 +348,14 @@
     httparty (0.13.7)
       json (~> 1.8)
       multi_xml (>= 0.5.2)
-    httpclient (2.8.2)
+    httpclient (2.8.2.4)
     i18n (0.7.0)
-    ice_nine (0.11.1)
-    influxdb (0.2.3)
+    ice_nine (0.11.2)
+    influxdb (0.3.13)
       cause
       json
     ipaddress (0.8.3)
-    jira-ruby (1.1.2)
+    jira-ruby (1.1.3)
       activesupport
       oauth (~> 0.5, >= 0.5.0)
     jquery-atwho-rails (1.3.2)
@@ -368,12 +371,12 @@
     json (1.8.3)
     json-schema (2.6.2)
       addressable (~> 2.3.8)
-    jwt (1.5.4)
+    jwt (1.5.6)
     kaminari (0.17.0)
       actionpack (>= 3.0.0)
       activesupport (>= 3.0.0)
     kgio (2.10.0)
-    knapsack (1.11.0)
+    knapsack (1.11.1)
       rake
       timecop (>= 0.1.0)
     launchy (2.4.3)
@@ -384,7 +387,7 @@
       actionmailer (>= 3.2)
       letter_opener (~> 1.0)
       railties (>= 3.2)
-    license_finder (2.1.0)
+    license_finder (2.1.2)
       bundler
       httparty
       rubyzip
@@ -392,32 +395,30 @@
       xml-simple
     licensee (8.0.0)
       rugged (>= 0.24b)
-    listen (3.0.5)
-      rb-fsevent (>= 0.9.3)
-      rb-inotify (>= 0.9)
+    listen (3.1.5)
+      rb-fsevent (~> 0.9, >= 0.9.4)
+      rb-inotify (~> 0.9, >= 0.9.7)
+      ruby_dep (~> 1.2)
     loofah (2.0.3)
       nokogiri (>= 1.5.9)
-    macaddr (1.7.1)
-      systemu (~> 2.6.2)
     mail (2.6.4)
       mime-types (>= 1.16, < 4)
     mail_room (0.9.0)
     method_source (0.8.2)
     mime-types (2.99.3)
-    mimemagic (0.3.0)
+    mimemagic (0.3.2)
     mini_portile2 (2.1.0)
     minitest (5.7.0)
     mousetrap-rails (1.4.6)
     multi_json (1.12.1)
     multi_xml (0.5.5)
     multipart-post (2.0.0)
-    mysql2 (0.3.20)
-    net-ldap (0.12.1)
-    net-ssh (3.0.1)
-    newrelic_rpm (3.16.0.318)
-    nokogiri (1.6.8)
+    mysql2 (0.3.21)
+    net-ldap (0.15.0)
+    net-ssh (3.0.2)
+    newrelic_rpm (3.17.1.326)
+    nokogiri (1.6.8.1)
       mini_portile2 (~> 2.1.0)
-      pkg-config (~> 1.1.7)
     numerizer (0.1.1)
     oauth (0.5.1)
     oauth2 (1.2.0)
@@ -428,16 +429,16 @@
       rack (>= 1.2, < 3)
     octokit (4.3.0)
       sawyer (~> 0.7.0, >= 0.5.3)
-    oj (2.17.4)
+    oj (2.17.5)
     omniauth (1.3.1)
       hashie (>= 1.2, < 4)
       rack (>= 1.0, < 3)
-    omniauth-auth0 (1.4.1)
+    omniauth-auth0 (1.4.2)
       omniauth-oauth2 (~> 1.1)
-    omniauth-azure-oauth2 (0.0.6)
+    omniauth-azure-oauth2 (0.0.8)
       jwt (~> 1.0)
       omniauth (~> 1.0)
-      omniauth-oauth2 (~> 1.1)
+      omniauth-oauth2 (~> 1.4)
     omniauth-bitbucket (0.0.2)
       multi_json (~> 1.7)
       omniauth (~> 1.1)
@@ -455,11 +456,10 @@
       omniauth (~> 1.0)
       omniauth-oauth2 (~> 1.0)
     omniauth-google-oauth2 (0.4.1)
-      addressable (~> 2.3)
-      jwt (~> 1.0)
+      jwt (~> 1.5.2)
       multi_json (~> 1.3)
       omniauth (>= 1.1.1)
-      omniauth-oauth2 (~> 1.3.1)
+      omniauth-oauth2 (>= 1.3.1)
     omniauth-kerberos (0.3.0)
       omniauth-multipassword
       timfel-krb5-auth (~> 0.8)
@@ -468,7 +468,7 @@
     omniauth-oauth (1.1.0)
       oauth
       omniauth (~> 1.0)
-    omniauth-oauth2 (1.3.1)
+    omniauth-oauth2 (1.4.0)
       oauth2 (~> 1.0)
       omniauth (~> 1.2)
     omniauth-saml (1.7.0)
@@ -486,33 +486,32 @@
     org-ruby (0.9.12)
       rubypants (~> 0.2)
     orm_adapter (0.5.0)
-    paranoia (2.1.4)
-      activerecord (~> 4.0)
-    parser (2.3.1.4)
+    paranoia (2.2.0)
+      activerecord (>= 4.0, < 5.1)
+    parser (2.3.2.0)
       ast (~> 2.2)
     pg (0.18.4)
-    pkg-config (1.1.7)
     poltergeist (1.9.0)
       capybara (~> 2.1)
       cliver (~> 0.3.1)
       multi_json (~> 1.0)
       websocket-driver (>= 0.2.0)
-    posix-spawn (0.3.11)
+    posix-spawn (0.3.12)
     powerpack (0.1.1)
-    premailer (1.8.6)
-      css_parser (>= 1.3.6)
+    premailer (1.8.7)
+      css_parser (>= 1.4.5)
       htmlentities (>= 4.0.0)
-    premailer-rails (1.9.2)
+    premailer-rails (1.9.4)
       actionmailer (>= 3, < 6)
       premailer (~> 1.7, >= 1.7.9)
-    pry (0.10.3)
+    pry (0.10.4)
       coderay (~> 1.1.0)
       method_source (~> 0.8.1)
       slop (~> 3.4)
     pry-rails (0.3.4)
       pry (>= 0.9.10)
     pyu-ruby-sasl (0.0.3.3)
-    rack (1.6.4)
+    rack (1.6.5)
     rack-accept (0.4.5)
       rack (>= 0.4)
     rack-attack (4.4.1)
@@ -557,17 +556,16 @@
     rainbow (2.1.0)
     raindrops (0.17.0)
     rake (10.5.0)
-    rb-fsevent (0.9.6)
-    rb-inotify (0.9.5)
+    rb-fsevent (0.9.8)
+    rb-inotify (0.9.7)
       ffi (>= 0.5.0)
-    rblineprof (0.3.6)
+    rblineprof (0.3.7)
       debugger-ruby_core_source (~> 1.3)
-    rdoc (4.2.2)
-      json (~> 1.4)
-    recaptcha (3.0.0)
+    rdoc (4.3.0)
+    recaptcha (3.4.0)
       json
-    redcarpet (3.3.3)
-    redis (3.2.2)
+    redcarpet (3.3.4)
+    redis (3.3.2)
     redis-actionpack (5.0.1)
       actionpack (>= 4.0, < 6)
       redis-rack (>= 1, < 3)
@@ -591,18 +589,18 @@
       listen (~> 3.0)
     responders (2.3.0)
       railties (>= 4.2.0, < 5.1)
-    rinku (2.0.0)
+    rinku (2.0.2)
     rotp (2.1.2)
     rouge (2.0.7)
-    rqrcode (0.7.0)
-      chunky_png
+    rqrcode (0.10.1)
+      chunky_png (~> 1.0)
     rqrcode-rails3 (0.1.7)
       rqrcode (>= 0.4.2)
     rspec (3.5.0)
       rspec-core (~> 3.5.0)
       rspec-expectations (~> 3.5.0)
       rspec-mocks (~> 3.5.0)
-    rspec-core (3.5.0)
+    rspec-core (3.5.4)
       rspec-support (~> 3.5.0)
     rspec-expectations (3.5.0)
       diff-lcs (>= 1.2.0, < 2.0)
@@ -610,7 +608,7 @@
     rspec-mocks (3.5.0)
       diff-lcs (>= 1.2.0, < 2.0)
       rspec-support (~> 3.5.0)
-    rspec-rails (3.5.0)
+    rspec-rails (3.5.2)
       actionpack (>= 3.0)
       activesupport (>= 3.0)
       railties (>= 3.0)
@@ -618,7 +616,7 @@
       rspec-expectations (~> 3.5.0)
       rspec-mocks (~> 3.5.0)
       rspec-support (~> 3.5.0)
-    rspec-retry (0.4.5)
+    rspec-retry (0.4.6)
       rspec-core
     rspec-support (3.5.0)
     rubocop (0.43.0)
@@ -627,20 +625,21 @@
       rainbow (>= 1.99.1, < 3.0)
       ruby-progressbar (~> 1.7)
       unicode-display_width (~> 1.0, >= 1.0.1)
-    rubocop-rspec (1.5.0)
-      rubocop (>= 0.40.0)
+    rubocop-rspec (1.5.3)
+      rubocop (>= 0.42.0)
     ruby-fogbugz (0.2.1)
       crack (~> 0.4)
     ruby-prof (0.16.2)
     ruby-progressbar (1.8.1)
     ruby-saml (1.4.1)
       nokogiri (>= 1.5.10)
-    ruby_parser (3.8.2)
+    ruby_dep (1.5.0)
+    ruby_parser (3.8.3)
       sexp_processor (~> 4.1)
-    rubyntlm (0.5.2)
-    rubypants (0.2.0)
+    rubyntlm (0.6.1)
+    rubypants (0.6.0)
     rubyzip (1.2.0)
-    rufus-scheduler (3.1.10)
+    rufus-scheduler (3.2.2)
     rugged (0.24.0)
     safe_yaml (1.0.4)
     sanitize (2.1.0)
@@ -661,7 +660,7 @@
     seed-fu (2.3.6)
       activerecord (>= 3.1)
       activesupport (>= 3.1)
-    select2-rails (3.5.9.3)
+    select2-rails (3.5.10)
       thor (~> 0.14)
     sentry-raven (2.0.2)
       faraday (>= 0.7.6, < 0.10.x)
@@ -671,15 +670,15 @@
       rack
     shoulda-matchers (2.8.0)
       activesupport (>= 3.0.0)
-    sidekiq (4.2.1)
+    sidekiq (4.2.6)
       concurrent-ruby (~> 1.0)
       connection_pool (~> 2.2, >= 2.2.0)
-      rack-protection (~> 1.5)
+      rack-protection (>= 1.5.0)
       redis (~> 3.2, >= 3.2.1)
-    sidekiq-cron (0.4.0)
+    sidekiq-cron (0.4.4)
       redis-namespace (>= 1.5.2)
       rufus-scheduler (>= 2.0.24)
-      sidekiq (>= 4.0.0)
+      sidekiq (>= 4.2.1)
     sidekiq-limit_fetch (3.4.0)
       sidekiq (>= 4)
     simplecov (0.12.0)
@@ -689,7 +688,7 @@
     simplecov-html (0.10.0)
     slack-notifier (1.2.1)
     slop (3.6.0)
-    spinach (0.8.10)
+    spinach (0.9.0)
       colorize
       gherkin-ruby (>= 0.3.2)
       json
@@ -713,7 +712,7 @@
       babel-source (>= 5.8.11)
       babel-transpiler
       sprockets (>= 3.0.0)
-    sprockets-rails (3.1.1)
+    sprockets-rails (3.2.0)
       actionpack (>= 4.0)
       activesupport (>= 4.0)
       sprockets (>= 3.0.0)
@@ -725,7 +724,7 @@
       activerecord (>= 4.1, < 5.1)
       state_machines-activemodel (>= 0.3.0)
     stringex (2.5.2)
-    sys-filesystem (1.1.6)
+    sys-filesystem (1.1.7)
       ffi
     sysexits (1.2.0)
     systemu (2.6.5)
@@ -759,7 +758,6 @@
     underscore-rails (1.8.3)
     unf (0.1.4)
       unf_ext
-    unf_ext (0.0.7.2)
     unicode-display_width (1.1.1)
     unicorn (5.1.0)
       kgio (~> 2.6)
@@ -768,15 +766,13 @@
       get_process_mem (~> 0)
       unicorn (>= 4, < 6)
     uniform_notifier (1.10.0)
-    uuid (2.3.8)
-      macaddr (~> 1.0)
     version_sorter (2.1.0)
     virtus (1.0.5)
       axiom-types (~> 0.1)
       coercible (~> 1.0)
       descendants_tracker (~> 0.0, >= 0.0.3)
       equalizer (~> 0.0, >= 0.0.9)
-    vmstat (2.2.0)
+    vmstat (2.2.1)
     warden (1.2.6)
       rack (>= 1.0)
     web-console (2.3.0)
@@ -787,7 +783,7 @@
     webmock (1.21.0)
       addressable (>= 2.3.6)
       crack (>= 0.3.2)
-    websocket-driver (0.6.3)
+    websocket-driver (0.6.4)
       websocket-extensions (>= 0.1.0)
     websocket-extensions (0.1.2)
     wikicloth (0.8.1)
@@ -981,6 +977,7 @@
   uglifier (~> 2.7.2)
   underscore-rails (~> 1.8.0)
   unf (~> 0.1.4)
+  unf_ext!
   unicorn (~> 5.1.0)
   unicorn-worker-killer (~> 0.4.4)
   version_sorter (~> 2.1.0)
